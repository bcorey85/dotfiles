#!/bin/bash
# Launch a coding layout in the current tmux window
# Usage: code [directory]
#   If directory is provided, all panes open there
#   Otherwise uses current directory
#
# Layout:
#   ┌──────────────┬──────────┐
#   │              │          │
#   │    nvim      │  claude  │
#   │              │          │
#   ├──────────────┤          │
#   │   terminal   │          │
#   └──────────────┴──────────┘

if [ -z "$TMUX" ]; then
    echo "Not in a tmux session"
    exit 1
fi

dir="${1:-.}"
dir="$(cd "$dir" && pwd)"

# Split right for claude (33% width)
tmux split-window -h -l 33% -c "$dir"

# Go back to left pane and split bottom for terminal (30% height)
tmux select-pane -L
tmux split-window -v -l 30% -c "$dir"

# Start claude in the right pane
tmux send-keys -t '{right}' 'claude' C-m

# Start nvim in the top-left pane
tmux select-pane -U
tmux send-keys 'nvim .' C-m
