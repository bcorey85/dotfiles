#!/bin/bash
# Persistent Claude popup via nested tmux session.
# Toggle with: prefix o (opens popup outside, detaches inside)
# Session persists in background so reopening resumes the conversation.

dir_name=$(basename "$PWD")
session="claude-${dir_name}"

# Allow nested tmux
unset TMUX

if tmux has-session -t "$session" 2>/dev/null; then
  tmux attach-session -t "$session"
else
  tmux new-session -s "$session" -c "$PWD" "claude --continue"
fi
