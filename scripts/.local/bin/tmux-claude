#!/bin/bash
# Persistent Claude session per project directory.
# Run in a narrow pane AND toggle via popup (prefix o) â€” both attach
# to the same tmux session so content stays in sync and reflows.

dir_name=$(basename "$PWD")
session="claude-${dir_name}"

# Allow nested tmux
unset TMUX

if tmux has-session -t "$session" 2>/dev/null; then
  tmux attach-session -t "$session"
else
  tmux new-session -s "$session" -c "$PWD" "claude"
fi
